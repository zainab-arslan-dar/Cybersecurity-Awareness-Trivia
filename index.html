<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Middlesex University ‚Äî Cybersecurity Trivia</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: linear-gradient(180deg, #2a2a3e 0%, #1c1c2b 100%);
      --card-bg: rgba(255, 255, 255, 0.05);
      --card-border: rgba(255, 255, 255, 0.1);
      --accent: #a78bfa;
      --accent-2: #2dd4bf;
      --text-primary: #f3f4f6;
      --text-muted: #9ca3af;
      --shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
      --radius: 16px;
      --success-bg: rgba(45, 212, 191, 0.1);
      --success-text: #2dd4bf;
      --error-bg: rgba(244, 63, 94, 0.1);
      --error-text: #f43f5e;
    }

    * {
      box-sizing: border-box;
      font-family: 'Inter', 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    }

    body {
      margin: 0;
      background: var(--bg);
      color: var(--text-primary);
      padding: 20px;
      overflow-x: hidden;
      min-height: 100vh;
    }

    header {
      display: flex;
      align-items: center;
      gap: 16px;
      justify-content: space-between;
      animation: fadeIn 1.5s ease-in-out;
      flex-wrap: wrap;
    }

    header h1 {
      margin: 0;
      font-size: 2.25rem;
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-fill-color: transparent;
      animation: gradientShift 4s infinite alternate ease-in-out;
    }

    header p {
      margin: 0;
      color: var(--text-muted);
      font-size: 1.1rem;
    }

    .controls {
      display: flex;
      gap: 10px;
      animation: fadeIn 2s ease-in-out;
      flex-wrap: wrap;
    }

    button {
      background: var(--accent);
      border: none;
      color: white;
      padding: 10px 18px;
      border-radius: 999px;
      cursor: pointer;
      font-weight: 700;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      transition: all .3s ease;
    }

    button:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 0 15px var(--accent), 0 6px 20px rgba(0, 0, 0, 0.3);
      filter: brightness(1.1);
    }

    button.secondary {
      background: var(--accent-2);
    }

    button.secondary:hover {
      box-shadow: 0 0 15px var(--accent-2), 0 6px 20px rgba(0, 0, 0, 0.3);
    }

    main {
      display: grid;
      /* Default desktop layout: main content and sidebar */
      grid-template-columns: 1fr 280px; 
      gap: 18px;
      margin-top: 18px;
    }

    .panel {
      background: var(--card-bg);
      backdrop-filter: blur(10px);
      border: 1px solid var(--card-border);
      border-radius: var(--radius);
      padding: 24px;
      box-shadow: var(--shadow);
      animation: fadeIn 1.5s ease-in-out;
    }

    .quiz-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 16px;
    }

    .card {
      padding: 16px;
      border-radius: 12px;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
      border: 1px solid var(--card-border);
      transition: all .3s ease;
      opacity: 0;
      animation: floatIn 0.8s cubic-bezier(0.25, 0.8, 0.25, 1) forwards;
    }

    .card:hover {
      transform: scale(1.03);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
      border-color: var(--accent);
    }

    .opt {
      padding: 10px;
      margin-top: 8px;
      border-radius: 8px;
      border: 1px dashed var(--card-border);
      cursor: pointer;
      transition: all .2s ease;
    }

    .opt:hover {
      border-color: var(--accent);
      background: rgba(167, 139, 250, 0.1);
      color: var(--accent);
      transform: translateX(5px);
    }

    .fillin {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .fillin-box {
      border-bottom: 1px solid var(--card-border);
      padding-bottom: 16px;
      opacity: 0;
      animation: floatIn 0.8s cubic-bezier(0.25, 0.8, 0.25, 1) forwards;
    }

    input[type=text] {
      padding: 10px;
      border-radius: 8px;
      border: 1px solid var(--card-border);
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-primary);
      margin-right: 8px;
      margin-top: 8px;
    }
    input[type=text]::placeholder {
      color: var(--text-muted);
    }

    .match-board {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .match-item {
      padding: 12px;
      border-radius: 10px;
      border: 1px solid var(--card-border);
      background: rgba(255, 255, 255, 0.05);
      cursor: pointer;
      transition: all .2s ease;
      opacity: 0;
      animation: floatIn 0.8s cubic-bezier(0.25, 0.8, 0.25, 1) forwards;
    }

    .match-item:hover {
      background: var(--success-bg);
      transform: scale(1.05);
      border-color: var(--accent-2);
    }

    .scoreboard {
      display: flex;
      align-items: center;
      gap: 12px;
      justify-content: space-between;
      flex-direction: column;
      text-align: center;
      margin-bottom: 24px; 
    }

    .score {
      font-size: 48px;
      font-weight: 800;
      margin-top: 10px;
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-fill-color: transparent;
      animation: pulse 2.5s infinite ease-in-out;
    }

    /* Timer CSS */
    .timer-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding-top: 16px;
        border-top: 1px solid var(--card-border);
    }

    .timer-display {
        font-size: 3rem; 
        font-weight: 800;
        color: var(--accent);
        text-shadow: 0 0 10px rgba(167, 139, 250, 0.5);
        margin-top: 10px;
        position: relative;
        padding-left: 50px; 
    }

    .timer-caption {
        font-size: 1.1rem;
        color: var(--text-muted);
        margin-bottom: 5px;
    }
    
    .timer-display.low-time {
        color: var(--error-text);
        animation: lowTimePulse 0.7s infinite alternate;
    }
    
    /* Clock Sticker Styling */
    .clock-sticker {
        position: absolute;
        left: 0;
        top: 50%;
        transform: translateY(-50%) scale(1.2);
        color: var(--accent-2);
        animation: tickTock 1s infinite steps(2);
        text-shadow: 0 0 8px rgba(45, 212, 191, 0.5);
        font-size: 30px;
    }
    /* End Timer CSS */


    .result-badge {
      padding: 6px 10px;
      border-radius: 999px;
      font-weight: 700;
      margin-left: 8px;
    }

    .correct {
      background: var(--success-bg);
      color: var(--success-text);
      border: 1px solid var(--success-text);
    }

    .incorrect {
      background: var(--error-bg);
      color: var(--error-text);
      border: 1px solid var(--error-text);
    }

    footer {
      grid-column: 1/-1;
      margin-top: 16px;
      color: var(--text-muted);
      text-align: center;
    }
    
    .shield-container {
      display: grid;
      place-items: center;
      margin-bottom: 16px;
      animation: shieldPulse 3s infinite ease-in-out;
    }

    .shield-svg {
      width: 100px;
      height: auto;
    }

    .shield-outline {
      stroke: var(--accent);
      transition: all 0.5s ease;
    }
    
    .shield-fill {
      transition: all 0.5s ease;
    }
    
    #shieldFillRect {
      transition: y 0.3s ease-out;
    }

    .shield-icon {
      transition: all 0.5s ease;
      transform-origin: center center;
    }

    .shield-lock {
      opacity: 1;
      transform: scale(1);
    }

    .shield-check {
      opacity: 0;
      transform: scale(0.5);
    }

    .shield-container.complete {
      animation: shieldPulseComplete 1.5s infinite ease-in-out;
    }

    .shield-container.complete .shield-lock {
      opacity: 0;
      transform: scale(0.5);
    }

    .shield-container.complete .shield-check {
      opacity: 1;
      transform: scale(1);
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes floatIn {
      0% {
        opacity: 0;
        transform: translateY(30px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes gradientShift {
      0% {
        filter: hue-rotate(0deg);
      }
      100% {
        filter: hue-rotate(45deg);
      }
    }

    @keyframes pulse {
      0%,
      100% {
        transform: scale(1);
        opacity: 0.8;
      }
      50% {
        transform: scale(1.1);
        opacity: 1;
      }
    }
    
    @keyframes shieldPulse {
      0%, 100% {
        filter: drop-shadow(0 0 3px var(--accent));
        transform: scale(1);
      }
      50% {
        filter: drop-shadow(0 0 10px var(--accent));
        transform: scale(1.05);
      }
    }

    @keyframes shieldPulseComplete {
      0%, 100% {
        filter: drop-shadow(0 0 5px var(--accent-2));
        transform: scale(1);
      }
      50% {
        filter: drop-shadow(0 0 20px var(--accent-2));
        transform: scale(1.1);
      }
    }

    @keyframes lowTimePulse {
        from { transform: scale(1); opacity: 1; }
        to { transform: scale(1.05); opacity: 0.9; }
    }
    
    @keyframes tickTock {
        0% { transform: translateY(-50%) rotate(0deg) scale(1.2); }
        100% { transform: translateY(-50%) rotate(10deg) scale(1.2); }
    }

    /* --- MOBILE RESPONSIVENESS MEDIA QUERY --- */
    @media (max-width: 1000px) {
      /* Stack the main content and sidebar */
      main {
        grid-template-columns: 1fr;
      }

      header {
        flex-direction: column;
        align-items: flex-start;
      }

      .controls {
        width: 100%;
        justify-content: center;
        margin-top: 15px;
      }

      header h1 {
        font-size: 1.75rem; /* Slightly smaller heading on mobile */
      }
      
      body {
        padding: 10px; /* Reduced padding on small screens */
      }
      
      .panel {
        padding: 15px; /* Reduced panel padding */
      }

      .match-board {
        /* Stack matching columns on very small screens if necessary, 
           but 1fr 1fr is usually fine unless content is long. */
        grid-template-columns: 1fr 1fr; 
      }
    }
  </style>
</head>
<body>
  <header>
    <div>
      <h1>Middlesex University Cybersecurity Awareness Week: Cybersecurity Trivia</h1>
      <p>üõ°Ô∏è Are You Safe Online? Test your cybersecurity knowledge with quizzes, matching challenges, and fill-in-the-blanks!</p>
    </div>
    <div class="controls">
      <button id="btnMC">üíª Multiple Choice</button>
      <button class="secondary" id="btnFill">üß† Cyber Knowledge Fill-in</button>
      <button id="btnMatch">üö© Flag Your Knowledge</button>
    </div>
  </header>

  <main>
    <section class="panel" id="leftPanel">
      <div id="content"></div>
    </section>

    <aside class="panel">
      <div class="scoreboard">
        
        <div class="shield-container" id="shieldContainer">
          <svg class="shield-svg" viewBox="0 0 100 120" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <clipPath id="shieldFillClip">
                <rect id="shieldFillRect" x="0" y="120" width="100" height="120" />
              </clipPath>
            </defs>
            
            <path class="shield-outline"
              d="M50 5 L95 30 V70 C95 100 65 115 50 120 C35 115 5 100 5 70 V30 Z"
              stroke-width="3" fill="var(--card-bg)" />
              
            <path class="shield-fill"
              d="M50 5 L95 30 V70 C95 100 65 115 50 120 C35 115 5 100 5 70 V30 Z"
              fill="var(--accent-2)" clip-path="url(#shieldFillClip)" />
              
            <path class="shield-icon shield-lock"
              d="M38 60 V45 C38 36.7 43.3 30 50 30 C56.7 30 62 36.7 62 45 V60 M30 60 H70 V90 H30 Z"
              stroke="var(--text-muted)" stroke-width="4" fill="none" stroke-linecap="round" stroke-linejoin="round" />
              
            <path class="shield-icon shield-check"
              d="M35 65 L48 78 L65 55"
              stroke="var(--text-primary)" stroke-width="6" fill="none" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </div>
        
        <div>Score Limit: 450</div>
        <div class="score" id="score">0</div>
      </div>
      
      <div class="timer-container">
          <div class="timer-caption">‚è±Ô∏è Time Remaining for Challenge</div>
          <div class="timer-display" id="timerDisplay">
             <span class="clock-sticker">‚è≥</span>
             --
          </div>
      </div>
      </aside>

    <footer>+10 points per correct answer. Reach 450 to celebrate! üéâ</footer>
  </main>

  <script>
    const content = document.getElementById('content');
    const scoreEl = document.getElementById('score');
    const timerDisplay = document.getElementById('timerDisplay');
    
    // --- Timer Variables and Logic ---
    let timeRemaining = 0;
    let timerInterval = null;
    let quizTypeStarted = { mc: false, fill: false, match: false };
    let quizPoints = { mc: 0, fill: 0, match: 0 }; 
    
    const TIMER_DURATIONS = {
        'mc': 30,    
        'fill': 25,  
        'match': 20  
    };
    
    const BONUS_POINTS = {
        'mc': 30,
        'fill': 40,
        'match': 30
    };

    function updateTimerDisplay(time) {
        timerDisplay.innerHTML = `<span class="clock-sticker">‚è≥</span> ${time < 10 ? '0' + time : time}`;
        if (time <= 10 && time > 0) {
            timerDisplay.classList.add('low-time');
        } else {
            timerDisplay.classList.remove('low-time');
        }
    }

    function checkQuizCompletion(quizKey) {
        let totalQuestions;

        switch (quizKey) {
            case 'mc':
                totalQuestions = multipleChoice.length;
                break;
            case 'fill':
                totalQuestions = fillBlanks.length;
                break;
            case 'match':
                totalQuestions = matchingPairs.length;
                break;
            default:
                return false;
        }

        const requiredPoints = totalQuestions * 10;
        
        if (quizPoints[quizKey] === requiredPoints) {
            const bonus = BONUS_POINTS[quizKey];
            addScore(bonus);
            alert(`‚ö° Time Bonus! You correctly completed all questions in ${quizKey} with time remaining for +${bonus} points!`);
            return true;
        }
        return false;
    }

    function stopTimer(quizKey, completed = true) {
        if (timerInterval) clearInterval(timerInterval);
        timerInterval = null;
        
        if (completed && timeRemaining > 0) {
            checkQuizCompletion(quizKey);
        }

        quizTypeStarted[quizKey] = true; 
        updateTimerDisplay(completed ? 0 : '--'); 
        timerDisplay.classList.remove('low-time');
    }

    function startTimer(duration, quizKey) {
        if (timerInterval) clearInterval(timerInterval);

        timeRemaining = duration;
        updateTimerDisplay(timeRemaining);

        timerInterval = setInterval(() => {
            timeRemaining--;
            updateTimerDisplay(timeRemaining);

            if (timeRemaining <= 0) {
                clearInterval(timerInterval);
                timerInterval = null;
                alert(`‚è∞ Time's up for the ${quizKey} challenge! All unsolved questions are now disabled.`);
                // In a real application, you'd add logic here to disable further interaction.
            }
        }, 1000);
    }
    
    function handleFirstInteraction(quizKey) {
        if (!quizTypeStarted[quizKey] && timerInterval === null) {
            startTimer(TIMER_DURATIONS[quizKey], quizKey);
        }
    }
    
    function resetTimerState(currentQuizKey) {
        if (timerInterval) clearInterval(timerInterval);
        timerInterval = null;
        updateTimerDisplay('--');
        
        quizPoints[currentQuizKey] = 0;
        
        Object.keys(quizTypeStarted).forEach(key => {
            if (key !== currentQuizKey) {
                quizTypeStarted[key] = false;
            }
        });
    }
    // --- End Timer Logic ---


    // --- Score Logic ---
    let score = 0;
    const maxScore = 450; 
    const shieldFillRect = document.getElementById('shieldFillRect');
    const shieldContainer = document.getElementById('shieldContainer');
    const shieldHeight = 120; 

    function addScore(n) {
      score += n;
      if (score > maxScore) score = maxScore;
      scoreEl.textContent = score;

      const fillPercent = score / maxScore;
      const newY = shieldHeight - (fillPercent * shieldHeight);
      shieldFillRect.setAttribute('y', newY);

      if (score >= maxScore) {
        alert('üéâ Congratulations! You reached full score!');
        shieldContainer.classList.add('complete');
      }
    }
    // --- End Score Logic ---


    document.getElementById('btnMC').onclick = renderMC;
    document.getElementById('btnFill').onclick = renderFill;
    document.getElementById('btnMatch').onclick = renderMatch;

    // --- DATA ---
    const multipleChoice = [
      { q: 'Web exploitation is the process of:', options: ['Making websites faster', 'Exploiting vulnerabilities in web apps', 'Designing webpages', 'Creating secure APIs'], answer: 1 },
      { q: 'Reverse engineering is:', options: ['Building from scratch', 'Understanding software internals', 'Encrypting data', 'Writing reports'], answer: 1 },
      { q: 'Most common cyber threat?', options: ['Human error', 'Hardware issues', 'Viruses', 'Hacktivism'], answer: 0 },
      { q: 'Company size matters to attackers?', options: ['Yes', 'No, all sizes targeted equally'], answer: 1 },
      { q: 'Vulnerable industries?', options: ['Finance, Healthcare, Education', 'Construction, Mining, Real Estate'], answer: 0 },
      { q: 'Strong password example?', options: ['m#P52s@ap$V', 'password123', '123456', 'abcdef'], answer: 0 },
      { q: 'Unknown email received?', options: ['Open it', 'Delete and ignore', 'Don‚Äôt open; if opened don‚Äôt click', 'Forward it'], answer: 2 },
      { q: 'VPN stands for?', options: ['Virtual Private Network', 'Very Private Network', 'Verified Public Network', 'Virtual Public Node'], answer: 0 },
      { q: 'Backup frequency?', options: ['Once a week', 'Only when problem', 'Every day', 'Whenever creating important files'], answer: 3 },
      { q: 'Bank email request for passwords?', options: ['Once a month', 'Never', 'Once a year', 'Every six months'], answer: 1 },
      { q: 'Secure website URL begins with?', options: ['HTTP', 'HTTPS', 'FTP', 'WWW'], answer: 1 },
      { q: 'Multi-factor authentication adds?', options: ['More clicks', 'Security layer', 'Slower login', 'Nothing'], answer: 1 },
      { q: 'Spear phishing targets?', options: ['Random users', 'Specific individuals', 'Government only', 'Hackers'], answer: 1 }
    ];
    const fillBlanks = [
      { q: 'The _____ cipher shifts letters by a fixed number.', a: 'Caesar' },
      { q: '_____ Injection can leak database data.', a: 'SQL' },
      { q: 'Analyzing code to find vulnerabilities is called _____ Engineering.', a: 'Reverse' },
      { q: 'A _____ Overflow exceeds memory limits.', a: 'Buffer' },
      { q: 'Cross-Site _____ injects scripts into web pages.', a: 'Scripting' },
      { q: '_____ phishing attempts mimic legitimate emails.', a: 'Spear' },
      { q: 'Using a _____ can hide your IP and encrypt traffic.', a: 'VPN' },
      { q: 'Keeping your software _____ prevents exploits.', a: 'Updated' },
      { q: 'Multi-Factor _____ adds a security layer.', a: 'Authentication' },
      { q: 'A secure website URL begins with _____.', a: 'HTTPS' }
    ];
    const matchingPairs = [
      { term: 'Caesar Cipher', def: 'Simple letter shift cipher' },
      { term: 'SQL Injection', def: 'Manipulates database queries' },
      { term: 'Reverse Engineering', def: 'Dissects software to understand internals' },
      { term: 'Buffer Overflow', def: 'Overwrites memory limits' },
      { term: 'XSS', def: 'Injects malicious scripts into websites' },
      { term: 'Steganography', def: 'Hiding data inside images or files' },
      { term: 'Brute Force Attack', def: 'Trying many passwords to gain access' },
      { term: 'Packet Sniffing', def: 'Capturing network data packets' },
      { term: 'CTF Flag', def: 'Secret string earned after solving a challenge' },
      { term: 'Privilege Escalation', def: 'Gaining higher system permissions' }
    ];
    // --- END DATA ---
    
    // --- Quiz Rendering Functions ---

    function renderMC() {
      resetTimerState('mc');
      content.innerHTML = '<h2>üíª Multiple Choice Quiz</h2>';
      const grid = document.createElement('div'); grid.className = 'quiz-grid';
      multipleChoice.forEach((m, i) => {
        const c = document.createElement('div'); c.className = 'card';
        c.style.animationDelay = `${i * 0.05}s`;
        c.innerHTML = `<h3>Q${i + 1}</h3><div>${m.q}</div>`;
        m.options.forEach((opt, idx) => {
          const o = document.createElement('div'); o.className = 'opt'; o.textContent = String.fromCharCode(65 + idx) + '. ' + opt;
          o.onclick = () => {
            handleFirstInteraction('mc'); 
            if (idx === m.answer) { 
                o.classList.add('correct'); 
                addScore(10); 
                quizPoints.mc += 10; 
                o.textContent += ' ‚úÖ'; 
            } else { 
                o.classList.add('incorrect'); 
                o.textContent += ' ‚ùå'; 
            }
            Array.from(c.querySelectorAll('.opt')).forEach(x => x.style.pointerEvents = 'none');
            
            if (Array.from(grid.querySelectorAll('.card')).every(card => card.querySelector('.correct, .incorrect'))) {
                stopTimer('mc', true); 
            }
          };
          c.appendChild(o);
        });
        grid.appendChild(c);
      });
      content.appendChild(grid);
    }

    function renderFill() {
      resetTimerState('fill');
      content.innerHTML = '<h2>üß† Cyber Knowledge Fill-in Quiz</h2>';
      const wrap = document.createElement('div'); wrap.className = 'fillin';
      fillBlanks.forEach((f, i) => {
        const box = document.createElement('div');
        box.className = 'fillin-box';
        box.style.animationDelay = `${i * 0.05}s`;
        box.innerHTML = `<b>${i + 1}. ${f.q}</b><br>`;
        const inp = document.createElement('input'); inp.placeholder = 'Type your answer...';
        const btn = document.createElement('button'); btn.textContent = 'Check';
        const res = document.createElement('span');
        
        inp.oninput = () => { handleFirstInteraction('fill'); }; 
        
        btn.onclick = () => {
            handleFirstInteraction('fill'); 
            if (inp.value.trim().toLowerCase() === f.a.toLowerCase()) { 
                res.textContent = '‚úÖ Correct! +10'; 
                res.className = 'result-badge correct'; 
                addScore(10); 
                quizPoints.fill += 10; 
            } else { 
                res.textContent = '‚ùå Correct: ' + f.a; 
                res.className = 'result-badge incorrect'; 
            }
            inp.disabled = true;
            btn.disabled = true;
            
            if (Array.from(wrap.querySelectorAll('.fillin-box')).every(b => b.querySelector('button').disabled)) {
                stopTimer('fill', true); 
            }
        };
        box.appendChild(inp); box.appendChild(btn); box.appendChild(res);
        wrap.appendChild(box);
      });
      content.appendChild(wrap);
    }

    function renderMatch() {
      resetTimerState('match');
      content.innerHTML = '<h2>üö© Flag Your Knowledge: The CTF Trivia Challenge</h2><p>Match the cybersecurity term with its definition!</p>';
      const board = document.createElement('div'); board.className = 'match-board';
      const termsCol = document.createElement('div'); const defsCol = document.createElement('div');
      const terms = shuffle(matchingPairs.map(p => p.term));
      const defs = shuffle(matchingPairs.map(p => p.def));
      let selectedTerm = null;
      let selectedTermEl = null;
      let matchesFound = 0;
      const totalMatches = matchingPairs.length;

      terms.forEach((t, i) => {
        const el = document.createElement('div'); el.className = 'match-item'; el.textContent = t;
        el.style.animationDelay = `${i * 0.05}s`;
        el.onclick = () => {
          handleFirstInteraction('match'); 
          Array.from(termsCol.children).forEach(c => { c.style.borderColor = 'var(--card-border)'; c.style.background = 'rgba(255, 255, 255, 0.05)'; });
          el.style.borderColor = 'var(--accent)';
          el.style.background = 'rgba(167, 139, 250, 0.1)';
          selectedTerm = t;
          selectedTermEl = el;
        };
        termsCol.appendChild(el);
      });
      defs.forEach((d, i) => {
        const el = document.createElement('div'); el.className = 'match-item'; el.textContent = d;
        el.style.animationDelay = `${(terms.length + i) * 0.05}s`;
        el.onclick = () => {
          if (!selectedTerm) { alert('Select a term from the left column first.'); return; }
          handleFirstInteraction('match'); 
          const correct = matchingPairs.find(p => p.term === selectedTerm).def;
          
          if (d === correct) {
            addScore(10);
            quizPoints.match += 10; 
            matchesFound++;
            el.style.opacity = 0.4;
            el.style.pointerEvents = 'none';
            selectedTermEl.style.opacity = 0.4;
            selectedTermEl.style.pointerEvents = 'none';
            
            if (matchesFound === totalMatches) {
                stopTimer('match', true); 
            }
          } else {
            alert('‚ùå Not a match. Try again.');
          }
          selectedTerm = null;
          if (selectedTermEl) { 
              selectedTermEl.style.borderColor = 'var(--card-border)';
              selectedTermEl.style.background = 'rgba(255, 255,255, 0.05)';
          }
        };
        defsCol.appendChild(el);
      });
      board.appendChild(termsCol); board.appendChild(defsCol); content.appendChild(board);
    }

    function shuffle(arr) { return arr.sort(() => Math.random() - 0.5); }

    // Render default view and set initial timer state
    renderMC();
    updateTimerDisplay('--');
  </script>
</body>
</html>
